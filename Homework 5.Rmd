---
title: "p8105_hw5_sd3730"
author: "Stacey Dai"
date: "2024-11-14"
output: github_document
---

```{r setup, message = FALSE, warning = FALSE}
library(ggplot2)
library(dplyr)
```

# Problem 1

```{r dup_bd, message = FALSE, warning = FALSE}
has_duplicate_birthday = function(n) {
  birthdays = sample(1:365, n, replace = TRUE)
  
  return(any(duplicated(birthdays)))
}
```

```{r sim, message = FALSE, warning = FALSE}
set.seed(123)

probabilities = sapply(2:50, function(n) {
  mean(replicate(10000, has_duplicate_birthday(n)))
})
```

```{r bdayplot, message = FALSE, warning = FALSE}
prob_data = data.frame(
  group_size = 2:50, 
  probability = probabilities
)

ggplot(prob_data, aes(x = group_size, y = probability)) +
  geom_line(color = "blue") +
  labs(
    title = "Probability of Shared Birthday in a Group",
    x = "Group Size",
    y = "Probability of Shared Birthday"
  ) +
  theme_minimal()
```
